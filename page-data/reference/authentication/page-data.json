{"componentChunkName":"component---src-templates-default-js","path":"/reference/authentication/","result":{"data":{"ploneCollection":null,"ploneDocument":{"id":"http://localhost:8080/Plone/reference/authentication","title":"Authenticating REST API calls","description":"","text":{"react":"[{\"type\":\"p\",\"props\":{\"children\":[\"For Plone sites requiring authentication to use Plone REST API (or limiting publishable content by permissions of specific user) you may use this guide to set up a safe method of authentication using \",{\"type\":\"a\",\"props\":{\"href\":\"http://plonerestapi.readthedocs.io/en/latest/authentication.html#json-web-tokens-jwt\",\"children\":[\"JWT\"]}},\" and \",{\"type\":\"a\",\"props\":{\"href\":\"https://github.com/motdotla/dotenv\",\"children\":[\"dotenv\"]}},\" configuration.\"]}},{\"type\":\"p\",\"props\":{\"children\":[{\"type\":\"strong\",\"props\":{\"children\":[\"Note:\"]}},\" In time of writing, Plone REST API only created tokens valid for the next 12 hours.\"]}},{\"type\":\"p\",\"props\":{\"children\":[\"In UNIX-like systems (OSX, Linux, Linux subsystem for Windows), a bash script would serve as a good way to retrieve the JWT from plone.restapi, by prompting for username and password:\"]}},{\"type\":\"pre\",\"props\":{\"children\":[{\"type\":\"code\",\"props\":{\"className\":\"language-bash\",\"children\":[\"bash\\nread -p \\\"Username: \\\" USERNAME\\nread -sp \\\"Password: \\\" PASSWORD\\ncurl -s -X POST http://localhost:8080/Plone/@login -H 'Accept: application/json' -H 'Content-Type: application/json' --data-raw '{\\\"login\\\": \\\"'\\\"$USERNAME\\\"'\\\", \\\"password\\\": \\\"'\\\"$PASSWORD\\\"'\\\"}'\\nexit\"]}}]}},{\"type\":\"p\",\"props\":{\"children\":[\"The above script will\"]}},{\"type\":\"ol\",\"props\":{\"children\":[{\"type\":\"li\",\"props\":{\"children\":[\"enter a new bash environment\"]}},{\"type\":\"li\",\"props\":{\"children\":[\"read username into environment variable\"]}},{\"type\":\"li\",\"props\":{\"children\":[\"read password into environment variable without displaying it when you type\"]}},{\"type\":\"li\",\"props\":{\"children\":[\"request authorization token\"]}},{\"type\":\"li\",\"props\":{\"children\":[\"exit bash to forget environment variables.\"]}}]}},{\"type\":\"p\",\"props\":{\"children\":[\"This would give you a token as output:\"]}},{\"type\":\"pre\",\"props\":{\"children\":[{\"type\":\"code\",\"props\":{\"className\":\"language-json\",\"children\":[\"{\\n  \\\"token\\\": \\\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmdWxsbmFtZSI6IkpvaG4gRG9lIiwic3ViIjoidXNlcm5hbWUiLCJleHAiOjE1Mjc0NDk0NTl9.epewKm09S6JXe07Ha6UNicN7v9MT32Rrkflxq2OqVRI\\\"\\n}\"]}}]}},{\"type\":\"p\",\"props\":{\"children\":[\"Install dotenv and setup \",{\"type\":\"code\",\"props\":{\"children\":[\".secrets\"]}},\" with the token so that it can be used in the Gatsby project:\"]}},{\"type\":\"pre\",\"props\":{\"children\":[{\"type\":\"code\",\"props\":{\"className\":\"language-bash\",\"children\":[\"// Install dotenv\\nyarn install dotenv\\n\\n\\n// In .env in the project folder\\nTOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmdWxsbmFtZSI6IkpvaG4gRG9lIiwic3ViIjoidXNlcm5hbWUiLCJleHAiOjE1Mjc0NDk0NTl9.epewKm09S6JXe07Ha6UNicN7v9MT32Rrkflxq2OqVRI\"]}}]}},{\"type\":\"p\",\"props\":{\"children\":[\"Finally setup \",{\"type\":\"code\",\"props\":{\"children\":[\"gatsby-config.js\"]}},\" to use this in your project:\"]}},{\"type\":\"pre\",\"props\":{\"children\":[{\"type\":\"code\",\"props\":{\"className\":\"language-javascript\",\"children\":[\"// Top of your file\\nrequire(\\\"dotenv\\\").config({\\n  path: '.secrets',\\n});\\n\\n// In plugins list\\nmodule.exports = {\\n  resolve: 'gatsby-source-plone',\\n    options: {\\n    baseUrl: 'http://localhost:8080/Plone/',\\n    token: process.env.TOKEN,\\n  }\\n};\"]}}]}},{\"type\":\"p\",\"props\":{\"children\":[{\"type\":\"strong\",\"props\":{\"children\":[\"Important!\"]}},\" Be careful in naming your environment variable file, because Gatsby will automatically include and make public all environment variables from files starting with \",{\"type\":\"code\",\"props\":{\"children\":[\".env.\"]}},\" (e.g. \",{\"type\":\"code\",\"props\":{\"children\":[\".env.production\"]}},\").\"]}}]"},"_path":"/reference/authentication/"},"ploneEvent":null,"ploneFolder":null,"ploneNewsItem":null,"ploneBreadcrumbs":{"items":[{"_id":"http://localhost:8080/Plone/reference","_path":"/reference/","title":"Docs"},{"_id":"http://localhost:8080/Plone/reference/authentication","_path":"/reference/authentication/","title":"Authenticating REST API calls"}]},"allPloneFile":{"edges":[]},"allPloneImage":{"edges":[]}},"pageContext":{}},"staticQueryHashes":["2891224598"]}